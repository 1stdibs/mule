
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:spring="http://www.springframework.org/schema/beans"
       xmlns:cxf="http://www.mulesoft.org/schema/mule/cxf"
      xmlns:cxf-core="http://cxf.apache.org/core"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.0/mule.xsd
       http://www.mulesoft.org/schema/mule/cxf http://www.mulesoft.org/schema/mule/cxf/3.0/mule-cxf.xsd">
    
    <!-- Initialize a static instance so we can use it with our client -->
    <cxf:configuration initializeStaticBusInstance="false"/>
    
    <model name="test">
    
        <service name="routeBasedOnSoapAction">
            <inbound>
                <inbound-endpoint address="http://localhost:63081/services/mtom" 
                                     exchange-pattern="request-response">
                    <cxf:proxy-service mtomEnabled="true"/>
                </inbound-endpoint>
            </inbound>
            <outbound>
                <pass-through-router>
                    <outbound-endpoint address="http://localhost:63081/services/mtom2"  
                                       exchange-pattern="request-response">
                        <cxf:proxy-client mtomEnabled="true"/>              
                    </outbound-endpoint>
                </pass-through-router>
            </outbound>
        </service>
        
        <service name="mycomponent">
            <inbound>
               <inbound-endpoint address="http://localhost:63081/services/mtom2" 
                                 exchange-pattern="request-response">
                   <cxf:jaxws-service mtomEnabled="true"/>
               </inbound-endpoint>
            </inbound>
            <component>
                <singleton-object class="org.mule.module.cxf.testmodels.TestMtomImpl"/>
            </component>
        </service>
    </model>
</mule>
