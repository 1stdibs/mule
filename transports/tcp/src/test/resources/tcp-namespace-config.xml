<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:spring="http://www.springframework.org/schema/beans"
       xmlns:tcp="http://www.mulesoft.org/schema/mule/tcp"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.0/mule.xsd
       http://www.mulesoft.org/schema/mule/tcp http://www.mulesoft.org/schema/mule/tcp/3.0/mule-tcp.xsd">

    <tcp:connector name="tcpConnector"
                   keepAlive="true"
                   receiveBufferSize="1024"
                   sendBufferSize="2048"
                   receiveBacklog="50"
                   reuseAddress="false"
                   clientSoTimeout="3000"
                   socketSoLinger="1234"/>

    <tcp:connector name="separateTimeouts"
                   clientSoTimeout="3000"
                   serverSoTimeout="4000"
                   socketPoolFactory-ref="socketPool"
                   socketFactory-ref="socketFactory"/>
                   
    <tcp:connector name="connectorWithProtocolClass">
        <tcp:custom-protocol class="org.mule.transport.tcp.TcpNamespaceHandlerTestCase$MockTcpProtocol"/>
    </tcp:connector>
                   
    <spring:bean name="socketFactory"
        class="org.mule.transport.tcp.TcpNamespaceHandlerTestCase$StubSocketFactory"/>

    <spring:bean name="socketPool"
        class="org.mule.transport.tcp.TcpNamespaceHandlerTestCase$StubSocketPoolFactory"/>
                   
    <tcp:polling-connector name="pollingConnector"
                   clientSoTimeout="3000"
                   pollingFrequency="4000"/>
                   
    <tcp:connector name="defaultExceptionPolicyConnector"
                   clientSoTimeout="3000"
                   serverSoTimeout="4000">
        <tcp:default-exception-policy/>
    </tcp:connector>
    
    <tcp:connector name="rewriteExceptionPolicyConnector"
                   clientSoTimeout="3000"
                   serverSoTimeout="4000">
        <tcp:rewrite-exception-policy/>
    </tcp:connector>
    
    <spring:bean id="theClass"
        factory-bean="rewriteExceptionPolicyConnector"
        factory-method="getClass"/>

    <spring:bean name="tcpProtocol" class="org.mule.transport.tcp.TcpNamespaceHandlerTestCase$MockTcpProtocol"/>
    <tcp:connector name="connectorWithProtocolRef">
        <tcp:custom-protocol ref="tcpProtocol"/>
    </tcp:connector>    

    <spring:bean id="classLoader"
            factory-bean="theClass"
            factory-method="getClassLoader"/>

    <tcp:connector name="custom-class-loading-protocol-connector">
        <tcp:custom-class-loading-protocol payloadOnly="true" classLoader-ref="classLoader"/>
    </tcp:connector>
    
    <spring:bean id="messageDispatcherFactory" class="org.mule.transport.tcp.LocalSocketTcpMessageDispatcherFactory"/>
    
    <tcp:connector name="messageDispatcherFactoryConnector" dispatcherFactory-ref="messageDispatcherFactory" >
        <tcp:rewrite-exception-policy/>
    </tcp:connector>
</mule>
